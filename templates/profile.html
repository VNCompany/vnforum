{% extends "base.html" %}

{% block content %}
    <div class="profile">
        <div class="p-title">
            Личный профиль
        </div>
        <div class="p-info">
            <div class="u-avatar">
                <img width="150" height="150" src="/uploads/profiles/{{ user.avatar }}" alt="{{ user.nickname }}">
            </div>
            <div class="u-info">
                <p class="u-nickname">{{ user.nickname }}</p>
                <p>Пол:
                    {% if user.sex == "male" %}
                        Мужской
                    {% else %}
                        Женский
                    {% endif %}
                </p>
                <p>Дата регистрации: {{ user.reg_date.strftime("%d.%m.%Y") }}</p>
                <p>Рейтинг: {{ user.rating }}</p>
            </div>
        </div>

        <div class="p-edit">
            <p>Изменить аватар:</p>
            {% if error is defined %}
                <p style="color: red">{{ error }}</p>
            {% endif %}
            <form enctype="multipart/form-data" method="post" id="change_avatar_form">
                <input type="file" accept="image/*" name="user_avatar">
                <a id="change_avatar-btn" class="flat-button form-btn disabled">Загрузить</a>
            </form>
        </div>
    </div>
{% endblock %}

{% block scripts %}
    <script type="text/javascript">
        $(document).ready(function () {
            $('input[type="file"]').change(function () {
                $('#change_avatar-btn').removeClass("disabled");
            });

            $('#change_avatar-btn').click(function () {
                if ($('input[type="file"]')[0].files.length > 0) {
                    $("#change_avatar_form").submit();
                }
            });
        });
    </script>
{% endblock %}